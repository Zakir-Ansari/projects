#!/bin/sh

set -e  # Stop on first error

CHANGED_FILES=$(git diff --cached --name-only)

if echo "$CHANGED_FILES" | grep -q "pick-kart/frontend"; then
  echo "⚡ Running frontend lint & format..."
  cd pick-kart/frontend
  if npm run format:fix && npm run lint; then
    echo "✅ Frontend checks passed!"
  else
    echo "❌ Frontend lint or format failed. Commit aborted."
    exit 1
  fi
fi

if echo "$CHANGED_FILES" | grep -q "pick-kart/backend"; then
  echo "⚡ Running backend lint & format..."
  echo "⚠️  No backend scripts configured yet."
fi

echo "🎉 All pre-commit checks completed successfully! You're good to go! 🚀"
